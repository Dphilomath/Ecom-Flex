<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>E-Commerce API</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        header {
            background-color: #4CAF50;
            color: white;
            padding: 20px;
      <!-- Updated on 2025-03-05 - Commit activity -->            text-align: center;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        h1 {
            margin: 0;
        }
        .card {
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        ul {
            list-style-type: none;
            padding: 0;
        }
        li {
            margin-bottom: 10px;
      <!-- Updated on 2025-02-09 - Commit activity -->        }
        a {
            color: #4CAF50;
            text-decoration: none;
        }
        a:hover {
            text-decoration: underline;
      <!-- Updated on 2025-01-28 - Commit activity -->        }
        .endpoint {
            background-color: #f5f5f5;
            padding: 8px;
            border-radius: 4px;
            font-family: monospace;
      <!-- Updated on 2025-01-19 - Commit activity -->            margin: 5px 0;
        }
        form {
            margin-top: 15px;
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        input[type="text"],
        input[type="password"] {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box;
        }
        button {
            background-color: #4CAF50;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 4px;
            cursor: pointer;
        }
        button:hover {
            background-color: #3e8e41;
        }
        .tab {
            overflow: hidden;
            border: 1px solid #ccc;
            background-color: #f1f1f1;
      <!-- Updated on 2025-02-14 - Commit activity -->            border-radius: 4px 4px 0 0;
        }
        .tab button {
            background-color: inherit;
            float: left;
            border: none;
            outline: none;
            cursor: pointer;
            padding: 10px 16px;
            transition: 0.3s;
            color: #333;
        }
        .tab button:hover {
            background-color: #ddd;
        }
        .tab button.active {
            background-color: #4CAF50;
            color: white;
        }
        .tabcontent {
            display: none;
            padding: 15px;
      <!-- Updated on 2025-01-10 - Commit activity -->            border: 1px solid #ccc;
            border-top: none;
            border-radius: 0 0 4px 4px;
        }
        .auth-response {
            margin-top: 15px;
      <!-- Updated on 2025-01-21 - Commit activity -->            padding: 10px;
            border-radius: 4px;
            display: none;
        }
        .success {
            background-color: #dff0d8;
            border: 1px solid #d6e9c6;
            color: #3c763d;
        }
        .error {
            background-color: #f2dede;
            border: 1px solid #ebccd1;
            color: #a94442;
      <!-- Updated on 2025-01-10 - Commit activity -->        }
        #logoutBtn {
            display: none;
        }
        #userInfo {
            display: none;
            margin-top: 15px;
        }
      <!-- Updated on 2025-02-06 - Commit activity -->    </style>
</head>
<body>
    <header>
      <!-- Updated on 2025-02-22 - Commit activity -->        <h1>E-Commerce API</h1>
        <p>Spring Boot Backend with REST and GraphQL Support</p>
    </header>

    <div class="card">
        <h2>Authentication</h2>
        <div id="authControls">
            <div class="tab">
                <button class="tablinks active" onclick="openAuthTab(event, 'Login')">Login</button>
                <button class="tablinks" onclick="openAuthTab(event, 'Register')">Register</button>
            </div>

            <div id="Login" class="tabcontent" style="display: block;">
                <form id="loginForm">
                    <div class="form-group">
                        <label for="username">Username:</label>
                        <input type="text" id="username" name="username" required>
                    </div>
                    <div class="form-group">
                        <label for="password">Password:</label>
                        <input type="password" id="password" name="password" required>
                    </div>
                    <button type="submit">Login</button>
                </form>
            </div>

            <div id="Register" class="tabcontent">
                <form id="registerForm">
                    <div class="form-group">
                        <label for="regUsername">Username:</label>
                        <input type="text" id="regUsername" name="username" required>
                    </div>
                    <div class="form-group">
                        <label for="regEmail">Email:</label>
                        <input type="text" id="regEmail" name="email" required>
                    </div>
                    <div class="form-group">
                        <label for="regPassword">Password:</label>
                        <input type="password" id="regPassword" name="password" required>
                    </div>
                    <button type="submit">Register</button>
                </form>
      <!-- Updated on 2025-02-27 - Commit activity -->            </div>
        </div>

        <div id="userInfo">
            <h3>Welcome, <span id="userDisplayName"></span>!</h3>
            <p>Role: <span id="userRole"></span></p>
            <button id="logoutBtn">Logout</button>
        </div>

        <div id="authResponse" class="auth-response"></div>
    </div>

    <div class="card">
        <h2>API Documentation</h2>
        <p>This application provides both REST and GraphQL APIs for e-commerce operations.</p>
        
        <h3>Key Features:</h3>
        <ul>
            <li>✅ Dual API support (REST and GraphQL)</li>
            <li>✅ Role-based access control (admin and regular users)</li>
            <li>✅ Flexible authentication (switch between JWT and session-based)</li>
            <li>✅ Product and category management</li>
            <li>✅ User management</li>
            <li>✅ Shopping cart functionality</li>
            <li>✅ Order processing</li>
            <li>✅ Product reviews and ratings</li>
        </ul>
    </div>

    <div class="card">
        <h2>Getting Started</h2>
        <p>Explore our GraphQL API:</p>
        <div class="endpoint"><a href="/graphiql" target="_blank">/graphiql</a> - GraphQL Interactive Explorer</div>
        
        <p>Database Console:</p>
        <div class="endpoint"><a href="/h2-console" target="_blank">/h2-console</a> - H2 Database Console</div>
        
        <p>API Documentation:</p>
        <div class="endpoint"><a href="/swagger-ui/index.html" target="_blank">/swagger-ui</a> - Swagger UI API Documentation</div>
        
        <p>Authentication (REST):</p>
        <div class="endpoint">POST /api/auth/register - Register a new user</div>
        <div class="endpoint">POST /api/auth/login - Login to get JWT token</div>
    </div>

    <div class="card">
        <h2>Admin Access</h2>
        <p>Admin credentials:</p>
        <ul>
            <li><strong>Username:</strong> admin</li>
            <li><strong>Password:</strong> admin123</li>
        </ul>
        <p>Regular user credentials:</p>
        <ul>
            <li><strong>Username:</strong> user</li>
            <li><strong>Password:</strong> user123</li>
        </ul>
        <p>Admin API endpoints:</p>
        <div class="endpoint">GET /api/admin/dashboard - Admin dashboard</div>
        <div class="endpoint">GET /api/admin/users - List all users</div>
        <div id="adminDashboardContainer" style="display: none;">
      <!-- Updated on 2025-01-25 - Commit activity -->            <h3>Admin Dashboard</h3>
            <pre id="adminDashboardData"></pre>
        </div>
    </div>

    <script>
        // Handle tab switching
        function openAuthTab(evt, tabName) {
      <!-- Updated on 2025-02-26 - Commit activity -->            var i, tabcontent, tablinks;
            
            tabcontent = document.getElementsByClassName("tabcontent");
            for (i = 0; i < tabcontent.length; i++) {
                tabcontent[i].style.display = "none";
            }
            
            tablinks = document.getElementsByClassName("tablinks");
            for (i = 0; i < tablinks.length; i++) {
                tablinks[i].className = tablinks[i].className.replace(" active", "");
            }
            
            document.getElementById(tabName).style.display = "block";
            evt.currentTarget.className += " active";
        }

        // Global variables
        let token = localStorage.getItem('jwt_token');
        let currentUser = JSON.parse(localStorage.getItem('current_user'));

        // Check if user is already logged in
        window.addEventListener('DOMContentLoaded', function() {
            if (token && currentUser) {
                showLoggedInUser(currentUser);
                
                // If user is admin, load admin dashboard
                if (currentUser.role === 'ADMIN') {
                    loadAdminDashboard();
                }
            }
        });

        // Login form submission
        document.getElementById('loginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            
            fetch('/api/auth/login', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    username: username,
                    password: password
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.token) {
                    // Save token and user info
                    token = data.token;
                    currentUser = data.user;
                    localStorage.setItem('jwt_token', token);
                    localStorage.setItem('current_user', JSON.stringify(currentUser));
                    
                    showLoggedInUser(currentUser);
                    showAuthResponse('Login successful!', true);
                    
                    // If user is admin, load admin dashboard
                    if (currentUser.roles && currentUser.roles.includes('ADMIN')) {
                        loadAdminDashboard();
      <!-- Updated on 2025-02-27 - Commit activity -->                    }
                } else {
                    showAuthResponse('Login failed: ' + (data.message || 'Unknown error'), false);
                }
            })
            .catch(error => {
                showAuthResponse('Login failed: ' + error.message, false);
            });
        });

        // Register form submission
        document.getElementById('registerForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const username = document.getElementById('regUsername').value;
            const email = document.getElementById('regEmail').value;
            const password = document.getElementById('regPassword').value;
            
            fetch('/api/auth/register', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    username: username,
                    email: email,
                    password: password
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.token) {
                    // Registration successful
                    token = data.token;
                    currentUser = data.user;
                    localStorage.setItem('jwt_token', token);
                    localStorage.setItem('current_user', JSON.stringify(currentUser));
                    
                    showLoggedInUser(currentUser);
                    showAuthResponse('Registration successful!', true);
                } else {
                    showAuthResponse('Registration failed: ' + (data.message || 'Unknown error'), false);
      <!-- Updated on 2025-02-03 - Commit activity -->                }
            })
            .catch(error => {
                showAuthResponse('Registration failed: ' + error.message, false);
            });
        });

        // Logout button
        document.getElementById('logoutBtn').addEventListener('click', function() {
            fetch('/api/auth/logout', {
                method: 'POST',
                headers: {
                    'Authorization': 'Bearer ' + token
                }
            })
            .then(() => {
                // Clear storage
                localStorage.removeItem('jwt_token');
                localStorage.removeItem('current_user');
                token = null;
                currentUser = null;
                
                // Reset UI
                document.getElementById('authControls').style.display = 'block';
                document.getElementById('userInfo').style.display = 'none';
      <!-- Updated on 2025-02-04 - Commit activity -->                document.getElementById('logoutBtn').style.display = 'none';
                document.getElementById('adminDashboardContainer').style.display = 'none';
                
                showAuthResponse('Logged out successfully', true);
            })
            .catch(error => {
                showAuthResponse('Logout failed: ' + error.message, false);
            });
        });

        // Helper function to show auth response message
        function showAuthResponse(message, isSuccess) {
            const authResponse = document.getElementById('authResponse');
            authResponse.textContent = message;
            authResponse.className = 'auth-response ' + (isSuccess ? 'success' : 'error');
            authResponse.style.display = 'block';
            
            // Hide message after 5 seconds
            setTimeout(() => {
                authResponse.style.display = 'none';
            }, 5000);
        }

        // Helper function to show logged in user info
        function showLoggedInUser(user) {
            document.getElementById('authControls').style.display = 'none';
            document.getElementById('userInfo').style.display = 'block';
            document.getElementById('logoutBtn').style.display = 'inline-block';
            
            document.getElementById('userDisplayName').textContent = user.username;
            
            // Determine user role
            let role = 'User';
            if (user.roles) {
                if (user.roles.includes('ADMIN')) {
                    role = 'Admin';
                }
            }
            document.getElementById('userRole').textContent = role;
        }

        // Function to load admin dashboard
        function loadAdminDashboard() {
            fetch('/api/admin/dashboard', {
                headers: {
                    'Authorization': 'Bearer ' + token
                }
            })
            .then(response => response.json())
            .then(data => {
                document.getElementById('adminDashboardContainer').style.display = 'block';
                document.getElementById('adminDashboardData').textContent = JSON.stringify(data, null, 2);
            })
            .catch(error => {
      <!-- Updated on 2025-01-31 - Commit activity -->                console.error('Error loading admin dashboard:', error);
            });
        }
    </script>
</body>
</html> 